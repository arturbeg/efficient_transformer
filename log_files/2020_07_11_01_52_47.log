INFO:root:./model_files/2020_07_11_01_52_47.pt
INFO:root:The batch size is: 64
INFO:root:Number of epochs is : 2
INFO:root:The context length is : 128
INFO:root:D_model is : 256
INFO:root:Number of attention heads is : 4
INFO:root:Number of decoder layers is : 3
INFO:root:Initial learning rate is : 1.0
INFO:root:Number of warmup steps is : 4000
INFO:root:k is : 2
INFO:root:Number of experts is : 64
INFO:root:Type of gating used : FNN gating
WARNING:absl:TFDS datasets with text encoding are deprecated and will be removed in a future version. Instead, you should use the plain text version and tokenize the text using `tensorflow_text` (See: https://www.tensorflow.org/tutorials/tensorflow_text/intro#tfdata_example)
INFO:absl:Load dataset info from ./subwords32k/lm1b/subwords32k/1.0.0
INFO:absl:Reusing dataset lm1b (./subwords32k/lm1b/subwords32k/1.0.0)
INFO:absl:Constructing tf.data.Dataset for split train, from ./subwords32k/lm1b/subwords32k/1.0.0
WARNING:absl:TFDS datasets with text encoding are deprecated and will be removed in a future version. Instead, you should use the plain text version and tokenize the text using `tensorflow_text` (See: https://www.tensorflow.org/tutorials/tensorflow_text/intro#tfdata_example)
INFO:absl:Load dataset info from ./subwords32k/lm1b/subwords32k/1.0.0
INFO:absl:Reusing dataset lm1b (./subwords32k/lm1b/subwords32k/1.0.0)
INFO:absl:Constructing tf.data.Dataset for split test, from ./subwords32k/lm1b/subwords32k/1.0.0
INFO:root:Gating function is: none
INFO:root:The optimizer used is: adam
INFO:root:Current Epoch is: 1
INFO:root:Running without errors
INFO:root:Learning rate has changed to: 3.186982954388445e-05
INFO:root:| epoch   1 | batch   128 | ms/batch 6583.99 | loss    10.6076 | aux_loss     0.4918 | ppl 40440.1798
INFO:root:Learning rate has changed to: 6.349260614556825e-05
INFO:root:| epoch   1 | batch   256 | ms/batch 6531.91 | loss     9.9362 | aux_loss     0.4879 | ppl 20664.2230
INFO:root:Learning rate has changed to: 9.511538274725204e-05
INFO:root:| epoch   1 | batch   384 | ms/batch 6605.27 | loss     8.0086 | aux_loss     0.4872 | ppl  3006.7211
INFO:root:Learning rate has changed to: 0.00012673815934893584
INFO:root:| epoch   1 | batch   512 | ms/batch 6577.74 | loss     7.3674 | aux_loss     0.4870 | ppl  1583.4927
INFO:root:Learning rate has changed to: 0.00015836093595061963
INFO:root:| epoch   1 | batch   640 | ms/batch 6523.40 | loss     7.1558 | aux_loss     0.4862 | ppl  1281.5103
INFO:root:Learning rate has changed to: 0.00018998371255230342
INFO:root:| epoch   1 | batch   768 | ms/batch 6588.67 | loss     6.9911 | aux_loss     0.4857 | ppl  1086.8796
INFO:root:Learning rate has changed to: 0.00022160648915398723
INFO:root:| epoch   1 | batch   896 | ms/batch 6600.37 | loss     6.8606 | aux_loss     0.4857 | ppl   953.9186
INFO:root:Learning rate has changed to: 0.000253229265755671
INFO:root:| epoch   1 | batch  1024 | ms/batch 6620.60 | loss     6.7433 | aux_loss     0.4855 | ppl   848.3461
INFO:root:Learning rate has changed to: 0.0002848520423573548
INFO:root:| epoch   1 | batch  1152 | ms/batch 6538.49 | loss     6.6244 | aux_loss     0.4852 | ppl   753.2266
INFO:root:Learning rate has changed to: 0.0003164748189590386
INFO:root:| epoch   1 | batch  1280 | ms/batch 6448.74 | loss     6.5351 | aux_loss     0.4856 | ppl   688.9009
INFO:root:Learning rate has changed to: 0.0003480975955607224
INFO:root:| epoch   1 | batch  1408 | ms/batch 5963.94 | loss     6.4501 | aux_loss     0.4850 | ppl   632.7749
INFO:root:Learning rate has changed to: 0.0003797203721624062
INFO:root:| epoch   1 | batch  1536 | ms/batch 5885.76 | loss     6.3772 | aux_loss     0.4863 | ppl   588.2859
INFO:root:Learning rate has changed to: 0.00041134314876409
INFO:root:| epoch   1 | batch  1664 | ms/batch 5886.53 | loss     6.3083 | aux_loss     0.4857 | ppl   549.0932
INFO:root:Learning rate has changed to: 0.0004429659253657738
INFO:root:| epoch   1 | batch  1792 | ms/batch 5890.76 | loss     6.2377 | aux_loss     0.4853 | ppl   511.6748
INFO:root:Learning rate has changed to: 0.0004745887019674576
INFO:root:| epoch   1 | batch  1920 | ms/batch 5936.58 | loss     6.1744 | aux_loss     0.4845 | ppl   480.2953
INFO:root:Learning rate has changed to: 0.0005062114785691414
INFO:root:| epoch   1 | batch  2048 | ms/batch 5887.76 | loss     6.1329 | aux_loss     0.4856 | ppl   460.7718
INFO:root:Learning rate has changed to: 0.0005378342551708252
INFO:root:| epoch   1 | batch  2176 | ms/batch 5884.21 | loss     6.0740 | aux_loss     0.4848 | ppl   434.4330
INFO:root:Learning rate has changed to: 0.000569457031772509
INFO:root:| epoch   1 | batch  2304 | ms/batch 5880.81 | loss     6.0248 | aux_loss     0.4858 | ppl   413.5746
INFO:root:Learning rate has changed to: 0.0006010798083741928
INFO:root:| epoch   1 | batch  2432 | ms/batch 5861.32 | loss     5.9691 | aux_loss     0.4851 | ppl   391.1542
INFO:root:Learning rate has changed to: 0.0006327025849758765
INFO:root:| epoch   1 | batch  2560 | ms/batch 5904.56 | loss     5.9377 | aux_loss     0.4857 | ppl   379.0635
INFO:root:Learning rate has changed to: 0.0006643253615775603
INFO:root:| epoch   1 | batch  2688 | ms/batch 5902.61 | loss     5.8970 | aux_loss     0.4851 | ppl   363.9619
INFO:root:Learning rate has changed to: 0.0006959481381792441
INFO:root:| epoch   1 | batch  2816 | ms/batch 5898.66 | loss     5.8714 | aux_loss     0.4856 | ppl   354.7531
INFO:root:Learning rate has changed to: 0.000727570914780928
INFO:root:| epoch   1 | batch  2944 | ms/batch 6007.42 | loss     5.8372 | aux_loss     0.4854 | ppl   342.8176
INFO:root:Learning rate has changed to: 0.0007591936913826118
INFO:root:| epoch   1 | batch  3072 | ms/batch 6037.85 | loss     5.7984 | aux_loss     0.4853 | ppl   329.7724
INFO:root:Learning rate has changed to: 0.0007908164679842956
INFO:root:| epoch   1 | batch  3200 | ms/batch 6074.79 | loss     5.7678 | aux_loss     0.4851 | ppl   319.8362
INFO:root:Learning rate has changed to: 0.0008224392445859793
INFO:root:| epoch   1 | batch  3328 | ms/batch 6028.64 | loss     5.7435 | aux_loss     0.4859 | ppl   312.1600
INFO:root:Learning rate has changed to: 0.0008540620211876631
INFO:root:| epoch   1 | batch  3456 | ms/batch 6022.96 | loss     5.7201 | aux_loss     0.4848 | ppl   304.9213
INFO:root:Learning rate has changed to: 0.0008856847977893469
INFO:root:| epoch   1 | batch  3584 | ms/batch 6006.92 | loss     5.6997 | aux_loss     0.4857 | ppl   298.7796
INFO:root:Learning rate has changed to: 0.0009173075743910307
INFO:root:| epoch   1 | batch  3712 | ms/batch 6022.20 | loss     5.6792 | aux_loss     0.4862 | ppl   292.7266
INFO:root:Learning rate has changed to: 0.0009489303509927146
INFO:root:| epoch   1 | batch  3840 | ms/batch 6053.33 | loss     5.6460 | aux_loss     0.4851 | ppl   283.1664
INFO:root:Learning rate has changed to: 0.0009805531275943983
INFO:root:| epoch   1 | batch  3968 | ms/batch 6043.97 | loss     5.6314 | aux_loss     0.4862 | ppl   279.0571
INFO:root:Learning rate has changed to: 0.0009764433125338821
INFO:root:| epoch   1 | batch  4096 | ms/batch 6051.41 | loss     5.6207 | aux_loss     0.4855 | ppl   276.0818
INFO:root:Learning rate has changed to: 0.0009615384615384616
INFO:root:| epoch   1 | batch  4224 | ms/batch 6049.27 | loss     5.6017 | aux_loss     0.4866 | ppl   270.8842
INFO:root:Learning rate has changed to: 0.0009472959569955596
INFO:root:| epoch   1 | batch  4352 | ms/batch 6048.54 | loss     5.5782 | aux_loss     0.4853 | ppl   264.6073
INFO:root:Learning rate has changed to: 0.0009336681528218903
INFO:root:| epoch   1 | batch  4480 | ms/batch 6120.75 | loss     5.5574 | aux_loss     0.4856 | ppl   259.1565
INFO:root:Learning rate has changed to: 0.0009206120672864873
INFO:root:| epoch   1 | batch  4608 | ms/batch 5920.94 | loss     5.5412 | aux_loss     0.4845 | ppl   254.9912
INFO:root:Learning rate has changed to: 0.0009080888118835636
INFO:root:| epoch   1 | batch  4736 | ms/batch 5910.39 | loss     5.5233 | aux_loss     0.4842 | ppl   250.4498
INFO:root:Learning rate has changed to: 0.0008960631034158175
INFO:root:| epoch   1 | batch  4864 | ms/batch 5918.77 | loss     5.5027 | aux_loss     0.4847 | ppl   245.3493
INFO:root:Learning rate has changed to: 0.0008845028453299376
INFO:root:| epoch   1 | batch  4992 | ms/batch 5917.20 | loss     5.4851 | aux_loss     0.4841 | ppl   241.0837
INFO:root:Learning rate has changed to: 0.0008733787669798303
INFO:root:| epoch   1 | batch  5120 | ms/batch 5967.34 | loss     5.4779 | aux_loss     0.4829 | ppl   239.3334
INFO:root:Learning rate has changed to: 0.0008626641115774413
INFO:root:| epoch   1 | batch  5248 | ms/batch 5925.76 | loss     5.4686 | aux_loss     0.4831 | ppl   237.1226
INFO:root:Learning rate has changed to: 0.000852334365251007
INFO:root:| epoch   1 | batch  5376 | ms/batch 6009.80 | loss     5.4522 | aux_loss     0.4824 | ppl   233.2604
INFO:root:Learning rate has changed to: 0.0008423670209604698
INFO:root:| epoch   1 | batch  5504 | ms/batch 6092.41 | loss     5.4377 | aux_loss     0.4822 | ppl   229.9038
INFO:root:Learning rate has changed to: 0.0008327413720912831
INFO:root:| epoch   1 | batch  5632 | ms/batch 5996.12 | loss     5.4241 | aux_loss     0.4819 | ppl   226.8169
INFO:root:Learning rate has changed to: 0.00082343833141581
INFO:root:| epoch   1 | batch  5760 | ms/batch 5983.38 | loss     5.4276 | aux_loss     0.4816 | ppl   227.6066
INFO:root:Learning rate has changed to: 0.0008144402718182064
INFO:root:| epoch   1 | batch  5888 | ms/batch 5931.51 | loss     5.4028 | aux_loss     0.4820 | ppl   222.0286
INFO:root:Learning rate has changed to: 0.0008057308857568942
INFO:root:| epoch   1 | batch  6016 | ms/batch 6016.70 | loss     5.3841 | aux_loss     0.4816 | ppl   217.9180
INFO:root:Learning rate has changed to: 0.0007972950609139956
INFO:root:| epoch   1 | batch  6144 | ms/batch 6051.70 | loss     5.3833 | aux_loss     0.4820 | ppl   217.7311
INFO:root:Learning rate has changed to: 0.0007891187698735106
INFO:root:| epoch   1 | batch  6272 | ms/batch 6053.60 | loss     5.3679 | aux_loss     0.4813 | ppl   214.4205
INFO:root:Learning rate has changed to: 0.0007811889719953762
INFO:root:| epoch   1 | batch  6400 | ms/batch 6124.85 | loss     5.3692 | aux_loss     0.4802 | ppl   214.7017
INFO:root:Learning rate has changed to: 0.0007734935259234094
INFO:root:| epoch   1 | batch  6528 | ms/batch 6084.99 | loss     5.3544 | aux_loss     0.4812 | ppl   211.5387
INFO:root:Learning rate has changed to: 0.0007660211113915147
INFO:root:| epoch   1 | batch  6656 | ms/batch 6097.00 | loss     5.3410 | aux_loss     0.4816 | ppl   208.7246
INFO:root:Learning rate has changed to: 0.0007587611591824277
INFO:root:| epoch   1 | batch  6784 | ms/batch 6254.40 | loss     5.3373 | aux_loss     0.4808 | ppl   207.9480
INFO:root:Learning rate has changed to: 0.0007517037882531398
INFO:root:| epoch   1 | batch  6912 | ms/batch 6254.22 | loss     5.3262 | aux_loss     0.4802 | ppl   205.6631
INFO:root:Learning rate has changed to: 0.0007448397491761886
INFO:root:| epoch   1 | batch  7040 | ms/batch 6194.70 | loss     5.3163 | aux_loss     0.4798 | ppl   203.6251
INFO:root:Learning rate has changed to: 0.000738160373160463
INFO:root:| epoch   1 | batch  7168 | ms/batch 6228.13 | loss     5.3114 | aux_loss     0.4791 | ppl   202.6327
INFO:root:Learning rate has changed to: 0.0007316575260124783
INFO:root:| epoch   1 | batch  7296 | ms/batch 6205.57 | loss     5.3052 | aux_loss     0.4806 | ppl   201.3776
INFO:root:Learning rate has changed to: 0.0007253235664820743
INFO:root:| epoch   1 | batch  7424 | ms/batch 6220.75 | loss     5.2901 | aux_loss     0.4800 | ppl   198.3659
INFO:root:Learning rate has changed to: 0.0007191513085074671
INFO:root:| epoch   1 | batch  7552 | ms/batch 6232.21 | loss     5.2828 | aux_loss     0.4792 | ppl   196.9208
INFO:root:Learning rate has changed to: 0.0007131339869354735
INFO:root:| epoch   1 | batch  7680 | ms/batch 6263.91 | loss     5.2765 | aux_loss     0.4797 | ppl   195.6903
INFO:root:Learning rate has changed to: 0.0007072652263450946
INFO:root:| epoch   1 | batch  7808 | ms/batch 6136.55 | loss     5.2726 | aux_loss     0.4800 | ppl   194.9226
INFO:root:Learning rate has changed to: 0.0007015390126478009
INFO:root:| epoch   1 | batch  7936 | ms/batch 6123.14 | loss     5.2668 | aux_loss     0.4796 | ppl   193.8005
INFO:root:Learning rate has changed to: 0.0006959496671769054
INFO:root:| epoch   1 | batch  8064 | ms/batch 6183.46 | loss     5.2624 | aux_loss     0.4793 | ppl   192.9443
INFO:root:Learning rate has changed to: 0.0006904918230122436
INFO:root:| epoch   1 | batch  8192 | ms/batch 6143.86 | loss     5.2514 | aux_loss     0.4786 | ppl   190.8302
INFO:root:Learning rate has changed to: 0.0006851604033157801
INFO:root:| epoch   1 | batch  8320 | ms/batch 6147.72 | loss     5.2432 | aux_loss     0.4792 | ppl   189.2785
INFO:root:Learning rate has changed to: 0.0006799506014793461
INFO:root:| epoch   1 | batch  8448 | ms/batch 6099.56 | loss     5.2392 | aux_loss     0.4793 | ppl   188.5164
INFO:root:Learning rate has changed to: 0.0006748578629080593
INFO:root:| epoch   1 | batch  8576 | ms/batch 6097.13 | loss     5.2339 | aux_loss     0.4787 | ppl   187.5185
INFO:root:Learning rate has changed to: 0.0006698778682824983
INFO:root:| epoch   1 | batch  8704 | ms/batch 6114.31 | loss     5.2175 | aux_loss     0.4781 | ppl   184.4641
INFO:root:Learning rate has changed to: 0.0006650065181598327
INFO:root:| epoch   1 | batch  8832 | ms/batch 6137.44 | loss     5.2212 | aux_loss     0.4787 | ppl   185.1625
INFO:root:Learning rate has changed to: 0.0006602399187891344
INFO:root:| epoch   1 | batch  8960 | ms/batch 6161.92 | loss     5.2169 | aux_loss     0.4781 | ppl   184.3563
INFO:root:Learning rate has changed to: 0.000655574369029326
INFO:root:| epoch   1 | batch  9088 | ms/batch 6156.21 | loss     5.2087 | aux_loss     0.4789 | ppl   182.8640
INFO:root:Learning rate has changed to: 0.0006510063482698811
INFO:root:| epoch   1 | batch  9216 | ms/batch 6148.73 | loss     5.1963 | aux_loss     0.4781 | ppl   180.5979
INFO:root:Learning rate has changed to: 0.0006465325052646858
INFO:root:| epoch   1 | batch  9344 | ms/batch 6094.60 | loss     5.2033 | aux_loss     0.4784 | ppl   181.8781
INFO:root:Learning rate has changed to: 0.0006421496477985839
INFO:root:| epoch   1 | batch  9472 | ms/batch 6148.67 | loss     5.1979 | aux_loss     0.4780 | ppl   180.8833
INFO:root:Learning rate has changed to: 0.0006378547331142038
INFO:root:| epoch   1 | batch  9600 | ms/batch 6171.46 | loss     5.1865 | aux_loss     0.4785 | ppl   178.8437
INFO:root:Learning rate has changed to: 0.0006336448590338265
INFO:root:| epoch   1 | batch  9728 | ms/batch 6127.59 | loss     5.1882 | aux_loss     0.4780 | ppl   179.1382
INFO:root:Learning rate has changed to: 0.000629517255717441
INFO:root:| epoch   1 | batch  9856 | ms/batch 6145.81 | loss     5.1762 | aux_loss     0.4795 | ppl   177.0070
INFO:root:Learning rate has changed to: 0.000625469278003796
INFO:root:| epoch   1 | batch  9984 | ms/batch 6152.30 | loss     5.1756 | aux_loss     0.4782 | ppl   176.9040
INFO:root:Learning rate has changed to: 0.0006214983982863358
INFO:root:| epoch   1 | batch 10112 | ms/batch 6141.20 | loss     5.1688 | aux_loss     0.4782 | ppl   175.7078
INFO:root:Learning rate has changed to: 0.0006176021998804238
INFO:root:| epoch   1 | batch 10240 | ms/batch 6146.83 | loss     5.1647 | aux_loss     0.4771 | ppl   174.9863
INFO:root:Learning rate has changed to: 0.0006137783708423093
INFO:root:| epoch   1 | batch 10368 | ms/batch 6258.00 | loss     5.1587 | aux_loss     0.4773 | ppl   173.9390
INFO:root:Learning rate has changed to: 0.0006100246982039221
INFO:root:| epoch   1 | batch 10496 | ms/batch 6198.84 | loss     5.1551 | aux_loss     0.4782 | ppl   173.3051
INFO:root:Learning rate has changed to: 0.0006063390625908325
INFO:root:| epoch   1 | batch 10624 | ms/batch 6251.92 | loss     5.1617 | aux_loss     0.4775 | ppl   174.4676
INFO:root:Learning rate has changed to: 0.0006027194331936383
INFO:root:| epoch   1 | batch 10752 | ms/batch 6176.85 | loss     5.1490 | aux_loss     0.4766 | ppl   172.2585
INFO:root:Learning rate has changed to: 0.000599163863065678
INFO:root:| epoch   1 | batch 10880 | ms/batch 6200.24 | loss     5.1495 | aux_loss     0.4780 | ppl   172.3525
INFO:root:Learning rate has changed to: 0.0005956704847223289
INFO:root:| epoch   1 | batch 11008 | ms/batch 6207.32 | loss     5.1465 | aux_loss     0.4770 | ppl   171.8212
INFO:root:Learning rate has changed to: 0.0005922375060193007
INFO:root:| epoch   1 | batch 11136 | ms/batch 6245.26 | loss     5.1361 | aux_loss     0.4785 | ppl   170.0458
